# Dockerfile for running integration tests in a Linux container

FROM oven/bun:1.1-debian AS base

# Install required system dependencies
RUN apt-get update && apt-get install -y python3 \
    curl \
    netcat-openbsd \
    gcc \
    libseccomp-dev \
    libseccomp2 \
    bubblewrap \
    socat \
    ripgrep \
    ca-certificates \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Copy everything (including node_modules)
COPY . .

# Build the project
RUN bun run build

# Run integration tests
CMD ["bun", "run", "test:integration"]
